{% extends "base.html" %}

{% block title %}–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è ‚Äî {{ partner.full_name }}{% endblock %}

{% block content %}
<h1 class="mb-2">‚úÖ –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–∞—Ä—Ç–Ω—ë—Ä–∞</h1>

<div class="card">
    <div class="card-header">
        <h2 class="card-title">{{ partner.full_name }}</h2>
        <span class="badge badge-pending">–û–∂–∏–¥–∞–µ—Ç</span>
    </div>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
        <div>
            <h3 class="mb-1" style="font-size: 1rem; color: var(--text-muted);">üìã –î–∞–Ω–Ω—ã–µ –ø–∞—Ä—Ç–Ω—ë—Ä–∞</h3>
            
            <table style="width: 100%;">
                <tr>
                    <td class="text-muted" style="width: 140px;">Telegram ID:</td>
                    <td><code>{{ partner.telegram_id }}</code></td>
                </tr>
                <tr>
                    <td class="text-muted">Username:</td>
                    <td>@{{ partner.telegram_username or '‚Äî' }}</td>
                </tr>
                <tr>
                    <td class="text-muted">–¢–µ–ª–µ—Ñ–æ–Ω:</td>
                    <td><strong>{{ partner.phone or '‚Äî' }}</strong></td>
                </tr>
                <tr>
                    <td class="text-muted">–î–∞—Ç–∞ –∑–∞—è–≤–∫–∏:</td>
                    <td>{{ partner.created_at.strftime('%d.%m.%Y %H:%M') if partner.created_at else '‚Äî' }}</td>
                </tr>
            </table>
            
            {% if partner.branches_text %}
            <div class="partner-branches mt-2">
                <strong>üè¢ –§–∏–ª–∏–∞–ª—ã (—Ç–µ–∫—Å—Ç –æ—Ç –ø–∞—Ä—Ç–Ω—ë—Ä–∞):</strong>
                <pre style="margin-top: 0.5rem;">{{ partner.branches_text }}</pre>
            </div>
            {% endif %}
        </div>
        
        <div>
            <h3 class="mb-1" style="font-size: 1rem; color: var(--text-muted);">üîó –ü—Ä–∏–≤—è–∑–∫–∞ –∫ —Ñ–∏–ª–∏–∞–ª–∞–º</h3>
            
            <form method="post" action="/partners/{{ partner.id }}/verify">
                {% if branches %}
                <p class="text-muted mb-1" style="font-size: 0.9rem;">
                    –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∏–ª–∏–∞–ª—ã, –∫ –∫–æ—Ç–æ—Ä—ã–º –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –ø–∞—Ä—Ç–Ω—ë—Ä:
                </p>
                
                <div style="max-height: 300px; overflow-y: auto; background: var(--bg-dark); border-radius: 8px; padding: 1rem;">
                    {% for branch in branches %}
                    <label style="display: flex; align-items: center; gap: 0.75rem; padding: 0.5rem 0; cursor: pointer;">
                        <input type="checkbox" name="branch_ids" value="{{ branch.id }}" 
                               style="width: 18px; height: 18px; accent-color: var(--accent);">
                        <span>
                            <strong>{{ branch.display_name or branch.city }}</strong>
                            <span class="text-muted" style="font-size: 0.85rem;">
                                ‚Äî {{ branch.city }}, {{ branch.address }}
                                {% if branch.name %}({{ branch.name }}){% endif %}
                            </span>
                        </span>
                    </label>
                    {% endfor %}
                </div>
                {% else %}
                <p class="text-muted">
                    ‚ö†Ô∏è –§–∏–ª–∏–∞–ª—ã –µ—â—ë –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã. 
                    <a href="/branches" style="color: var(--accent);">–î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª–∏–∞–ª</a>
                </p>
                {% endif %}
                
                <div class="mt-2 flex gap-1">
                    <button type="submit" class="btn btn-success">‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é</button>
                    <a href="/" class="btn">–û—Ç–º–µ–Ω–∞</a>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="card mt-2">
    <h3 style="font-size: 1rem; color: var(--text-muted); margin-bottom: 1rem;">‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å –∑–∞—è–≤–∫—É</h3>
    
    <form method="post" action="/partners/{{ partner.id }}/reject">
        <div class="form-group">
            <label class="form-label">–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</label>
            <input type="text" name="reason" class="form-input" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ">
        </div>
        <button type="submit" class="btn btn-danger">‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å –∑–∞—è–≤–∫—É</button>
    </form>
</div>
{% endblock %}


